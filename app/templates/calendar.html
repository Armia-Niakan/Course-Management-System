<!DOCTYPE html>
<html>
<head>
    <title>{{ username }}'s Dashboard</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='w3.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<style>
    .w3-hover-rounded:hover {
      border-radius: 8px;
    }
</style>

<body class="w3-light-grey">

<!-- Top Navigation -->
<div class="w3-top">
    <div class="w3-bar w3-deep-purple w3-card">
        <a href="/dashboard" class="w3-bar-item w3-button w3-padding-large w3-hover-rounded">
            <i class="fas fa-tachometer-alt"></i> Dashboard
        </a>
        <a href="/courses" class="w3-bar-item w3-button w3-padding-large w3-hover-rounded">
            <i class="fas fa-book"></i> Courses
        </a> 
        <a href="/calendar" class="w3-bar-item w3-button w3-padding-large w3-white w3-round-large">
            <i class="fas fa-calendar"></i> Calendar
        </a>
        <button class="w3-button w3-padding-large w3-right w3-hover-rounded" onclick="w3_open()">
            <i class="fas fa-user-circle"></i> {{ username }}
        </button>
    </div>
</div>

<!-- Right Sidebar -->
<div class="w3-sidebar w3-bar-block w3-white w3-card w3-animate-right" 
     style="width:280px;right:0;display:none;z-index:3" id="mySidebar">
    <button onclick="w3_close()" class="w3-bar-item w3-button w3-large w3-right-align">
        <i class="fas fa-times"></i>
    </button>
    <div class="w3-container w3-padding-16 w3-center">
        <div class="w3-display-container" style="width:100%"></div>
        <h3 class="w3-margin-top"><b>{{ username }}</b></h3>
        <span class="w3-tag w3-round w3-deep-purple">{{ role|capitalize }}</span>
    </div>
    <div class="w3-bar-block">
        <a href="/profile" class="w3-bar-item w3-button w3-padding">
            <i class="fas fa-user w3-margin-right"></i> Profile
        </a>
        <a href="/settings" class="w3-bar-item w3-button w3-padding">
            <i class="fas fa-cog w3-margin-right"></i> Settings
        </a>
        <a href="/logout" class="w3-bar-item w3-button w3-padding">
            <i class="fas fa-sign-out-alt w3-margin-right"></i> Logout
        </a>
    </div>
</div>

<!-- Overlay -->
<div class="w3-overlay w3-animate-opacity" onclick="w3_close()" style="cursor:pointer" id="myOverlay"></div>

<!-- Page content -->
<div class="w3-main" style="margin-top:46px;margin-right:0">

    <header class="w3-container w3-center w3-padding-32">
        {% if role == 'student' %}
        <h1><b>{{ username }}'s Class Schedule</b></h1>
        <p class="w3-opacity">View your weekly classes</p>
        {% else %}
        <h1><b>{{ username }}'s Teaching Schedule</b></h1>
        <p class="w3-opacity">View your weekly courses</p>
        {% endif %}
    </header>
    
<div class="w3-container w3-margin">
    <div class="w3-responsive">
        <table class="w3-table-all w3-hoverable w3-card-4 w3-centered">
            <thead>
                <tr class="w3-grey">
                    {% for day in calendar_data.keys() %}
                    <th>{{ day }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% set max_rows = calendar_data.values() | map('length') | max %}
                {% for i in range(max_rows) %}
                <tr>
                    {% for day, courses in calendar_data.items() %}
                    <td>
                        {% if i < courses|length %}
                            {% set course = courses[i] %}
                            <div class="w3-card w3-white w3-round-large w3-margin-bottom">
                                <div class="w3-container w3-padding-small">
                                    <span class="w3-tag w3-round-xxlarge w3-deep-purple w3-medium w3-margin-bottom">
                                        {{ course.time }}
                                    </span><br>
                                    <strong>{{ course.name }}</strong><br>
                                    {% if role == 'student' %}
                                        <span class="w3-small">
                                            <i class="fas fa-user-tie"></i> 
                                            Teacher: {{ course.teacher_name }}
                                        </span><br>
                                    {% else %}
                                        <span class="w3-small">
                                            <i class="fas fa-users"></i> 
                                            Students: {{ course.student_count }}/{{ course.max_students }}
                                        </span><br>
                                    {% endif %}
                                    <p class="w3-small">
                                        <i class="fas fa-clock"></i> {{ course.duration }} hour(s)
                                    </p>
                                    <a href="{{ url_for('course.course_detail', course_id=course.id) }}" class="w3-button w3-deep-purple w3-round-large w3-small">
                                        <i class="fas fa-book-open"></i> Details
                                    </a>
                                </div>
                            </div>
                        {% else %}
                            <span class="w3-opacity w3-small">â€”</span>
                        {% endif %}
                    </td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<script>
    function w3_open() {
        document.getElementById("mySidebar").style.display = "block";
        document.getElementById("myOverlay").style.display = "block";
    }
    
    function w3_close() {
        document.getElementById("mySidebar").style.display = "none";
        document.getElementById("myOverlay").style.display = "none";
    }
</script>

</body>
</html>